- apt:
    name: "{{ item }}"
    update_cache: yes
  with_items:
    - make
    - diffstat
    - chrpath
    - gcc
    - g++
    - texi2html
    - texinfo
    - git


- user:
    name: yocto
    group: yocto
    comment: "User for building yoctos images"

- file:
    path: /u02/yocto
    state: directory
    mode: 0755

- git:
    repo: https://git.yoctoproject.org/git/poky
    dest: /u02/yocto/ 
    version: jethro
    force: yes

- git:
    repo: https://github.com/meta-debian/meta-debian.git
    dest: /u02/yocto/meta-debian
    version: jethro
    force: yes

- file:
    path: /u02/yocto
    state: directory
    owner: yocto
    group: yocto
    mode: 0755
    recurse: yes


- copy: 
    src: /u02/yocto/meta-debian/conf/local.conf.sample
    dest: /u02/yocto/meta-debian/conf/local.conf
    owner: yocto
    group: yocto
    mode: 0644

- lineinfile:
    name: /u02/yocto/meta-debian/conf/local.conf
    regexp: '^MACHINE \?\?= \"qemux86\"'
    line: '#MACHINE \?\?= \"qemux86\"'

- lineinfile:
    name: /u02/yocto/meta-debian/conf/local.conf
    regexp: '^#MACHINE \?\= \"qemumips\"'
    line: 'MACHINE \?\= \"qemumips\"'

